<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run SMC^2 — smc2 • mcstate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run SMC^2 — smc2"><meta property="og:description" content="Run a SMC^2. This is experimental and subject to change. Use at
your own risk."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcstate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/deterministic.html">Deterministic models</a>
    </li>
    <li>
      <a href="../articles/if2.html">Inference with iterated filtering</a>
    </li>
    <li>
      <a href="../articles/kalman.html">Validation of SMC using a Kalman filter</a>
    </li>
    <li>
      <a href="../articles/nested_sir_models.html">Nested SIR Models</a>
    </li>
    <li>
      <a href="../articles/parallelisation.html">Parallelisation of inference</a>
    </li>
    <li>
      <a href="../articles/restart.html">Restarting pMCMC</a>
    </li>
    <li>
      <a href="../articles/sir_models.html">SIR models with odin, dust and mcstate</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mrc-ide/mcstate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run SMC^2</h1>
    <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate/blob/HEAD/R/smc2.R" class="external-link"><code>R/smc2.R</code></a></small>
    <div class="hidden name"><code>smc2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run a SMC^2. This is experimental and subject to change. Use at
your own risk.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smc2</span><span class="op">(</span><span class="va">pars</span>, <span class="va">filter</span>, <span class="va">control</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pars</dt>
<dd><p>A <code><a href="smc2_parameters.html">smc2_parameters</a></code> object containing
information about parameters (ranges, priors, proposal kernel,
translation functions for use with the particle filter).</p></dd>


<dt>filter</dt>
<dd><p>A <code><a href="particle_filter.html">particle_filter</a></code> object</p></dd>


<dt>control</dt>
<dd><p>A <a href="smc2_control.html">smc2_control</a> object to control the
behaviour of the algorithm</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>smc2_result</code> object, with elements</p><ul><li><p><code>pars</code>: a matrix of sampled parameters (n_parameter_set long)</p></li>
<li><p><code>probabilities</code>: a matrix of probabilities (<code>log_prior</code>, <code>log_likelihood</code>,
<code>log_posterior</code> and <code>weight</code>). The latter is the log posterior
normalised over all samples</p></li>
<li><p><code>statistics</code>: interesting or useful statistics about your sample,
including the <code>ess</code> (effective sample size, over time),
<code>acceptance_rate</code> (where a regeneration step was done, the acceptance
rate), <code>n_particles</code>, <code>n_parameter_sets</code> and <code>n_steps</code> (inputs to
the simulation). The <code>effort</code> field is a rough calculation of the
number of particle-filter runs that this run was worth.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># We use an example from dust which implements an epidemiological SIR</span></span></span>
<span class="r-in"><span><span class="co"># (Susceptible-Infected-Recovered) model; see vignette("sir_models")</span></span></span>
<span class="r-in"><span><span class="co"># for more background, as this example follows from the pMCMC example</span></span></span>
<span class="r-in"><span><span class="co"># there</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The key tuning here is the number of particles per filter and number</span></span></span>
<span class="r-in"><span><span class="co"># of parameter sets to consider simultaneously. Ordinarily these would</span></span></span>
<span class="r-in"><span><span class="co"># be set (much) higher with an increase in computing time</span></span></span>
<span class="r-in"><span><span class="va">n_particles</span> <span class="op">&lt;-</span> <span class="fl">42</span></span></span>
<span class="r-in"><span><span class="va">n_parameter_sets</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic epidemiological (Susceptible-Infected-Recovered) model</span></span></span>
<span class="r-in"><span><span class="va">sir</span> <span class="op">&lt;-</span> <span class="fu">dust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dust/man/dust_example.html" class="external-link">dust_example</a></span><span class="op">(</span><span class="st">"sir"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pre-computed incidence data</span></span></span>
<span class="r-in"><span><span class="va">incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sir_incidence.csv"</span>, package <span class="op">=</span> <span class="st">"mcstate"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Annotate the data so that it is suitable for the particle filter to use</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="particle_filter_data.html">particle_filter_data</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="st">"day"</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'initial_time' should be provided. I'm assuming '0' which is one time unit before the first time in your data (1), but this might not be appropriate. This will become an error in a future version of mcstate</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset the output during run</span></span></span>
<span class="r-in"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">info</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>run <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The comparison function, used to compare simulated data with observe</span></span></span>
<span class="r-in"><span><span class="co"># data, given the above subset</span></span></span>
<span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">state</span>, <span class="va">observed</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">exp_noise</span> <span class="op">&lt;-</span> <span class="fl">1e6</span></span></span>
<span class="r-in"><span>  <span class="va">incidence_modelled</span> <span class="op">&lt;-</span> <span class="va">state</span><span class="op">[</span><span class="fl">1L</span>, , drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">incidence_observed</span> <span class="op">&lt;-</span> <span class="va">observed</span><span class="op">$</span><span class="va">cases</span></span></span>
<span class="r-in"><span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">incidence_modelled</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">incidence_modelled</span><span class="op">)</span>, rate <span class="op">=</span> <span class="va">exp_noise</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">incidence_observed</span>, lambda <span class="op">=</span> <span class="va">lambda</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally, construct the particle filter:</span></span></span>
<span class="r-in"><span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="va"><a href="particle_filter.html">particle_filter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">dat</span>, <span class="va">sir</span>, <span class="va">n_particles</span>, <span class="va">compare</span>,</span></span>
<span class="r-in"><span>                                       index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To control the smc2 we need to specify the parameters to consider</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="va"><a href="smc2_parameters.html">smc2_parameters</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_parameter.html">smc2_parameter</a></span><span class="op">(</span><span class="st">"beta"</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_parameter.html">smc2_parameter</a></span><span class="op">(</span><span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_control.html">smc2_control</a></span><span class="op">(</span><span class="va">n_parameter_sets</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then we run the particle filter</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu">smc2</span><span class="op">(</span><span class="va">pars</span>, <span class="va">filter</span>, <span class="va">control</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished 100 steps in 4 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This returns quite a lot of information about the fit, and this will</span></span></span>
<span class="r-in"><span><span class="co"># change in future versions</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta     gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.9549419 0.9226837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.9076964 0.8501227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.6861023 0.5124258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.4733528 0.2464084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.3329879 0.2690083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.4157179 0.2756735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.6306680 0.3118022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.8593084 0.5033835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.4228297 0.2434155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.7613022 0.7118823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.5207209 0.3803546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.5668609 0.3817547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.4640919 0.2903486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.4114577 0.2744632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.6599055 0.5318405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.6671389 0.5235704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.9999649 0.9238741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.4343369 0.2844818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       log_prior log_likelihood log_posterior       weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]         0      -275.8553     -275.8553 1.606282e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]         0      -276.1228     -276.1228 1.229282e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]         0      -268.2317     -268.2317 3.286530e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]         0      -263.8450     -263.8450 2.641524e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]         0      -259.7607     -259.7607 1.569102e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]         0      -256.8073     -256.8073 3.007951e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]         0      -280.1212     -280.1212 2.255080e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]         0      -279.1445     -279.1445 5.988915e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]         0      -260.5388     -260.5388 7.206212e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]         0      -273.1212     -273.1212 2.473192e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]         0      -262.9907     -262.9907 6.206604e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]         0      -261.2793     -261.2793 3.436519e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]         0      -261.1184     -261.1184 4.036496e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]         0      -259.7132     -259.7132 1.645360e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]         0      -272.7429     -272.7429 3.610079e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]         0      -263.5565     -263.5565 3.524887e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]         0      -277.3034     -277.3034 3.775223e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]         0      -253.9850     -253.9850 5.057990e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]         0      -254.0964     -254.0964 4.524723e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]         0      -258.2880     -258.2880 6.842746e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 17.117092 11.961735  8.204669 16.256308 13.291454 12.131947 10.974376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8]  8.768810 15.286213 11.856751  9.683432 10.783284  8.977379 17.064429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [15] 14.396185 12.353040 11.122073 10.168630  8.904058 15.043791 10.341715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [22] 10.748471  8.600119 12.728187 11.201522  9.384770 13.645836 10.015987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [29]  8.337727 17.039665 14.936260 13.069222 12.741636 10.283858 11.625582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] 11.041593  9.974958 17.943411 15.750932 13.175514 11.198493  8.122256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 19.692267 16.705627 18.070309 17.005194 11.617834  9.992624 19.234045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [50] 10.955990 12.796412  9.289936 19.631928 12.840949 14.427512 14.128495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 10.879213  8.960663 19.517741 19.137751 18.360640 15.771009 13.947639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [64] 12.714465 12.623091  9.917313 18.506715 18.923427 18.367858 16.606272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] 13.953784 13.828780 12.379156 15.944468 11.552038  8.111513 18.469461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [78] 17.985455 14.914573 13.617201 14.537852 15.121365 10.204479  8.533563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 19.618287 19.285753 18.887039 17.524268 16.855423 14.658326  9.219110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [92] 16.780858 17.718004 16.926841 17.405991 12.249930 11.211470 11.948223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [99]  7.821049 19.418316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$acceptance_rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   NA   NA 0.65   NA   NA   NA   NA 0.40   NA   NA 0.75   NA 0.45   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [16]   NA   NA   NA 0.40   NA   NA   NA 0.35   NA   NA 0.30   NA   NA 0.50   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31]   NA   NA   NA   NA   NA   NA 0.60   NA   NA   NA   NA 0.30   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [46]   NA   NA 0.30   NA   NA   NA 0.45   NA   NA   NA   NA   NA 0.35   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61]   NA   NA   NA   NA   NA 0.40   NA   NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [76] 0.35   NA   NA   NA   NA   NA   NA   NA 0.25   NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 0.30   NA   NA   NA   NA   NA   NA   NA 0.30   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_particles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_parameter_sets</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_steps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$effort</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "smc2_result"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most useful is likely the predict method:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta     gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.4343369 0.2844818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.4157179 0.2756735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.3008650 0.1644318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.3008650 0.1644318</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rich FitzJohn, Marc Baguelin, Edward Knock, Lilith Whittles, John Lees, Raphael Sonabend.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

