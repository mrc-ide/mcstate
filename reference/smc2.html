<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run SMC^2 — smc2 • mcstate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run SMC^2 — smc2"><meta property="og:description" content="Run a SMC^2. This is experimental and subject to change. Use at
your own risk."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcstate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/deterministic.html">Deterministic models</a>
    </li>
    <li>
      <a href="../articles/if2.html">Inference with iterated filtering</a>
    </li>
    <li>
      <a href="../articles/kalman.html">Validation of SMC using a Kalman filter</a>
    </li>
    <li>
      <a href="../articles/nested_sir_models.html">Nested SIR Models</a>
    </li>
    <li>
      <a href="../articles/parallelisation.html">Parallelisation of inference</a>
    </li>
    <li>
      <a href="../articles/restart.html">Restarting pMCMC</a>
    </li>
    <li>
      <a href="../articles/sir_models.html">SIR models with odin, dust and mcstate</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mrc-ide/mcstate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run SMC^2</h1>
    <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate/blob/HEAD/R/smc2.R" class="external-link"><code>R/smc2.R</code></a></small>
    <div class="hidden name"><code>smc2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run a SMC^2. This is experimental and subject to change. Use at
your own risk.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smc2</span><span class="op">(</span><span class="va">pars</span>, <span class="va">filter</span>, <span class="va">control</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pars</dt>
<dd><p>A <code><a href="smc2_parameters.html">smc2_parameters</a></code> object containing
information about parameters (ranges, priors, proposal kernel,
translation functions for use with the particle filter).</p></dd>


<dt>filter</dt>
<dd><p>A <code><a href="particle_filter.html">particle_filter</a></code> object</p></dd>


<dt>control</dt>
<dd><p>A <a href="smc2_control.html">smc2_control</a> object to control the
behaviour of the algorithm</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>smc2_result</code> object, with elements</p><ul><li><p><code>pars</code>: a matrix of sampled parameters (n_parameter_set long)</p></li>
<li><p><code>probabilities</code>: a matrix of probabilities (<code>log_prior</code>, <code>log_likelihood</code>,
<code>log_posterior</code> and <code>weight</code>). The latter is the log posterior
normalised over all samples</p></li>
<li><p><code>statistics</code>: interesting or useful statistics about your sample,
including the <code>ess</code> (effective sample size, over time),
<code>acceptance_rate</code> (where a regeneration step was done, the acceptance
rate), <code>n_particles</code>, <code>n_parameter_sets</code> and <code>n_steps</code> (inputs to
the simulation). The <code>effort</code> field is a rough calculation of the
number of particle-filter runs that this run was worth.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># We use an example from dust which implements an epidemiological SIR</span></span></span>
<span class="r-in"><span><span class="co"># (Susceptible-Infected-Recovered) model; see vignette("sir_models")</span></span></span>
<span class="r-in"><span><span class="co"># for more background, as this example follows from the pMCMC example</span></span></span>
<span class="r-in"><span><span class="co"># there</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The key tuning here is the number of particles per filter and number</span></span></span>
<span class="r-in"><span><span class="co"># of parameter sets to consider simultaneously. Ordinarily these would</span></span></span>
<span class="r-in"><span><span class="co"># be set (much) higher with an increase in computing time</span></span></span>
<span class="r-in"><span><span class="va">n_particles</span> <span class="op">&lt;-</span> <span class="fl">42</span></span></span>
<span class="r-in"><span><span class="va">n_parameter_sets</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic epidemiological (Susceptible-Infected-Recovered) model</span></span></span>
<span class="r-in"><span><span class="va">sir</span> <span class="op">&lt;-</span> <span class="fu">dust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dust/man/dust_example.html" class="external-link">dust_example</a></span><span class="op">(</span><span class="st">"sir"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pre-computed incidence data</span></span></span>
<span class="r-in"><span><span class="va">incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sir_incidence.csv"</span>, package <span class="op">=</span> <span class="st">"mcstate"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Annotate the data so that it is suitable for the particle filter to use</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="particle_filter_data.html">particle_filter_data</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="st">"day"</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'initial_time' should be provided. I'm assuming '0' which is one time unit before the first time in your data (1), but this might not be appropriate. This will become an error in a future version of mcstate</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset the output during run</span></span></span>
<span class="r-in"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">info</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>run <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The comparison function, used to compare simulated data with observe</span></span></span>
<span class="r-in"><span><span class="co"># data, given the above subset</span></span></span>
<span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">state</span>, <span class="va">observed</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">exp_noise</span> <span class="op">&lt;-</span> <span class="fl">1e6</span></span></span>
<span class="r-in"><span>  <span class="va">incidence_modelled</span> <span class="op">&lt;-</span> <span class="va">state</span><span class="op">[</span><span class="fl">1L</span>, , drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">incidence_observed</span> <span class="op">&lt;-</span> <span class="va">observed</span><span class="op">$</span><span class="va">cases</span></span></span>
<span class="r-in"><span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">incidence_modelled</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">incidence_modelled</span><span class="op">)</span>, rate <span class="op">=</span> <span class="va">exp_noise</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">incidence_observed</span>, lambda <span class="op">=</span> <span class="va">lambda</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally, construct the particle filter:</span></span></span>
<span class="r-in"><span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="va"><a href="particle_filter.html">particle_filter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">dat</span>, <span class="va">sir</span>, <span class="va">n_particles</span>, <span class="va">compare</span>,</span></span>
<span class="r-in"><span>                                       index <span class="op">=</span> <span class="va">index</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To control the smc2 we need to specify the parameters to consider</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="va"><a href="smc2_parameters.html">smc2_parameters</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_parameter.html">smc2_parameter</a></span><span class="op">(</span><span class="st">"beta"</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_parameter.html">smc2_parameter</a></span><span class="op">(</span><span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu"><a href="smc2_control.html">smc2_control</a></span><span class="op">(</span><span class="va">n_parameter_sets</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then we run the particle filter</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mcstate</span><span class="fu">::</span><span class="fu">smc2</span><span class="op">(</span><span class="va">pars</span>, <span class="va">filter</span>, <span class="va">control</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished 100 steps in 6 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This returns quite a lot of information about the fit, and this will</span></span></span>
<span class="r-in"><span><span class="co"># change in future versions</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta      gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.4418851 0.28123026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.3239820 0.17526245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.1991936 0.11729941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.2610502 0.13454510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.2270018 0.13457145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.4492536 0.26552855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.3446401 0.18390169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.6200668 0.32067321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.2878217 0.14097331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.7624764 0.38740850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.6022278 0.36433840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.5551875 0.39779537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.2100341 0.05587271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.3348741 0.08377828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.2524407 0.04452127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.5894194 0.28066616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.3580242 0.21492076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.3732186 0.26043912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.1459721 0.06106597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.2616924 0.08501286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       log_prior log_likelihood log_posterior       weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]         0      -258.7682     -258.7682 2.465518e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]         0      -250.7326     -250.7326 7.616094e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]         0      -246.6116     -246.6116 4.693369e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]         0      -252.3305     -252.3305 1.540951e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]         0      -246.5194     -246.5194 5.146355e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]         0      -264.5839     -264.5839 7.348176e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]         0      -253.7712     -253.7712 3.648337e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]         0      -272.3785     -272.3785 3.027345e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]         0      -251.0659     -251.0659 5.457261e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]         0      -281.8849     -281.8849 2.251576e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]         0      -267.7904     -267.7904 2.976063e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]         0      -262.2583     -262.2583 7.519868e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]         0      -283.0790     -283.0790 6.821797e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]         0      -339.4890     -339.4890 2.164436e-41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]         0      -343.7167     -343.7167 3.156904e-43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]         0      -280.4538     -280.4538 9.418470e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]         0      -253.5801     -253.5801 4.416701e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]         0      -254.3804     -254.3804 1.983890e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]         0      -253.6646     -253.6646 4.058835e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]         0      -273.3563     -273.3563 1.138651e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 16.707501 11.210249  8.957282 12.857705  9.314145 15.489856 12.611136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [8] 12.470643 11.019158 10.251319 10.173058  6.533471  8.724749 11.338064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [15]  8.962647 12.253916  9.250176  7.422315  7.223400  6.844648  5.798044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [22] 11.777400  7.930840  7.911735  8.670792  7.609419 10.559394  4.452653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [29]  8.777507 11.569345  6.748967 10.921305  9.765402  5.942803 16.673150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] 12.430254 11.096575 10.169770  9.389314 18.663811 16.631027 14.087918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 14.170804 13.439504 12.672523 11.949258 11.760461 11.851287 11.359755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [50] 10.296517 10.308349  9.324673 16.931650 16.653587 17.364600 15.912557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 15.792880 14.747438 14.555634 13.362701 12.405150 10.408873  9.709516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [64] 19.713042 18.844006 18.183263 15.518057 15.354167 14.720344 14.166092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] 13.003477 13.156065 12.106025 13.405520 12.265321 10.689874  9.689506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [78] 19.791883 18.560035 17.895789 18.494144 18.726600 17.199672 14.510901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 13.324985 13.585946 14.092594 10.886969  9.648965 17.778481  9.467498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [92] 16.319266 16.362508 15.551296 15.885099 13.065130 12.627112 12.630387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [99]  9.543546 18.175308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$acceptance_rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   NA   NA 0.75   NA 0.80   NA   NA   NA   NA   NA   NA 0.75 0.70   NA 0.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [16]   NA 0.45 0.50 0.65 0.35 0.55   NA 0.60 0.70 0.45 0.75   NA 0.70 0.45   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] 0.55   NA 0.65 0.40   NA   NA   NA   NA 0.50   NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [46]   NA   NA   NA   NA   NA   NA 0.65   NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61]   NA   NA 0.35   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [76]   NA 0.60   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA 0.40   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 0.40   NA   NA   NA   NA   NA   NA   NA 0.25   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_particles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_parameter_sets</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$n_steps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics$effort</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 201.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "smc2_result"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most useful is likely the predict method:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta     gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.1991936 0.1172994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.2270018 0.1345714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.1991936 0.1172994</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rich FitzJohn, Marc Baguelin, Edward Knock, Lilith Whittles, John Lees, Raphael Sonabend.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

