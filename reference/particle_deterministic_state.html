<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Deterministic particle state — particle_deterministic_state • mcstate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Deterministic particle state — particle_deterministic_state"><meta property="og:description" content="Deterministic particle internal state. This object is
not ordinarily constructed directly by users, but via the
$run_begin method to particle_deterministic. It
provides an advanced interface to the deterministic particle
that allows partially running over part of the time trajectory.
This state object has a number of public fields that you can read
but must not write (they are not read-only so you could write
them, but don't)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcstate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/deterministic.html">Deterministic models</a>
    </li>
    <li>
      <a href="../articles/if2.html">Inference with iterated filtering</a>
    </li>
    <li>
      <a href="../articles/kalman.html">Validation of SMC using a Kalman filter</a>
    </li>
    <li>
      <a href="../articles/nested_sir_models.html">Nested SIR Models</a>
    </li>
    <li>
      <a href="../articles/parallelisation.html">Parallelisation of inference</a>
    </li>
    <li>
      <a href="../articles/restart.html">Restarting pMCMC</a>
    </li>
    <li>
      <a href="../articles/sir_models.html">SIR models with odin, dust and mcstate</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mrc-ide/mcstate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Deterministic particle state</h1>
    <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate/blob/HEAD/R/deterministic_state.R" class="external-link"><code>R/deterministic_state.R</code></a></small>
    <div class="hidden name"><code>particle_deterministic_state.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Deterministic particle internal state. This object is
not ordinarily constructed directly by users, but via the
<code>$run_begin</code> method to <a href="particle_deterministic.html">particle_deterministic</a>. It
provides an advanced interface to the deterministic particle
that allows partially running over part of the time trajectory.</p>
<p>This state object has a number of public fields that you can read
but must not write (they are not read-only so you <em>could</em> write
them, but don't).</p>
    </div>


    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>model</code></dt>
<dd><p>The dust model being simulated</p></dd>


<dt><code>history</code></dt>
<dd><p>The particle history, if created with
<code>save_history = TRUE</code>.</p></dd>


<dt><code>restart_state</code></dt>
<dd><p>Full model state at a series of points in
time, if the model was created with non-<code>NULL</code> <code>save_restart</code>.
This is a 3d array as described in <a href="particle_filter.html">particle_filter</a></p></dd>


<dt><code>log_likelihood</code></dt>
<dd><p>The log-likelihood so far. This starts at
0 when initialised and accumulates value for each step taken.</p></dd>


<dt><code>current_time_index</code></dt>
<dd><p>The index of the last completed step.</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-particle_deterministic_state-new"><code>particle_deterministic_state$new()</code></a></p></li>
<li><p><a href="#method-particle_deterministic_state-run"><code>particle_deterministic_state$run()</code></a></p></li>
<li><p><a href="#method-particle_deterministic_state-step"><code>particle_deterministic_state$step()</code></a></p></li>
<li><p><a href="#method-particle_deterministic_state-fork_multistage"><code>particle_deterministic_state$fork_multistage()</code></a></p></li>
</ul></div><p></p><hr><a id="method-particle_deterministic_state-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialise the deterministic particle state. Ordinarily
this should not be called by users, and so arguments are barely
documented.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/particle_deterministic_state.html">particle_deterministic_state</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">generator</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">data_split</span>,</span>
<span>  <span class="va">times</span>,</span>
<span>  <span class="va">has_multiple_parameters</span>,</span>
<span>  <span class="va">n_threads</span>,</span>
<span>  <span class="va">initial</span>,</span>
<span>  <span class="va">index</span>,</span>
<span>  <span class="va">compare</span>,</span>
<span>  <span class="va">constant_log_likelihood</span>,</span>
<span>  <span class="va">save_history</span>,</span>
<span>  <span class="va">save_restart</span>,</span>
<span>  <span class="va">stochastic_schedule</span>,</span>
<span>  <span class="va">ode_control</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>pars</code></dt>
<dd><p>Parameters for a single phase</p></dd>


<dt><code>generator</code></dt>
<dd><p>A dust generator object</p></dd>


<dt><code>model</code></dt>
<dd><p>If the generator has previously been initialised</p></dd>


<dt><code>data</code></dt>
<dd><p>A <a href="particle_filter_data.html">particle_filter_data</a> data object</p></dd>


<dt><code>data_split</code></dt>
<dd><p>The same data as <code>data</code> but split by step</p></dd>


<dt><code>times</code></dt>
<dd><p>A matrix of time step beginning and ends</p></dd>


<dt><code>has_multiple_parameters</code></dt>
<dd><p>Compute multiple likelihoods at once?</p></dd>


<dt><code>n_threads</code></dt>
<dd><p>The number of threads to use</p></dd>


<dt><code>initial</code></dt>
<dd><p>Initial condition function (or <code>NULL</code>)</p></dd>


<dt><code>index</code></dt>
<dd><p>Index function (or <code>NULL</code>)</p></dd>


<dt><code>compare</code></dt>
<dd><p>Compare function</p></dd>


<dt><code>constant_log_likelihood</code></dt>
<dd><p>Constant log likelihood function</p></dd>


<dt><code>save_history</code></dt>
<dd><p>Logical, indicating if we should save history</p></dd>


<dt><code>save_restart</code></dt>
<dd><p>Vector of time steps to save restart at</p></dd>


<dt><code>stochastic_schedule</code></dt>
<dd><p>Vector of times to perform stochastic updates</p></dd>


<dt><code>ode_control</code></dt>
<dd><p>Tuning control for stepper</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-particle_deterministic_state-run"></a><div class="section">
<h3 id="method-run-">Method <code>run()</code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>Run the deterministic particle to the end of the data.
This is a convenience function around <code>$step()</code> which provides the
correct value of <code>time_index</code></p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">particle_deterministic_state</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-particle_deterministic_state-step"></a><div class="section">
<h3 id="method-step-">Method <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step()</a></code><a class="anchor" aria-label="anchor" href="#method-step-"></a></h3>
<p>Take a step with the deterministic particle. This moves
the system forward one step within the <em>data</em> (which
may correspond to more than one step with your model) and
returns the likelihood so far.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">particle_deterministic_state</span><span class="op">$</span><span class="fu">step</span><span class="op">(</span><span class="va">time_index</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time_index</code></dt>
<dd><p>The step <em>index</em> to move to. This is not the same
as the model step, nor time, so be careful (it's the index within
the data provided to the filter). It is an error to provide
a value here that is lower than the current step index, or past
the end of the data.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-particle_deterministic_state-fork_multistage"></a><div class="section">
<h3 id="method-fork-multistage-">Method <code>fork_multistage()</code><a class="anchor" aria-label="anchor" href="#method-fork-multistage-"></a></h3>
<p>Create a new <code>deterministic_particle_state</code> object based
on this one (same model, position in time within the data) but with
new parameters, to support the "multistage particle filter".</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">particle_deterministic_state</span><span class="op">$</span><span class="fu">fork_multistage</span><span class="op">(</span><span class="va">model</span>, <span class="va">pars</span>, <span class="va">transform_state</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>model</code></dt>
<dd><p>A model object</p></dd>


<dt><code>pars</code></dt>
<dd><p>New model parameters</p></dd>


<dt><code>transform_state</code></dt>
<dd><p>A function to transform the model state
from the old to the new parameter set.  See
<code><a href="multistage_epoch.html">multistage_epoch()</a></code> for details.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rich FitzJohn, Marc Baguelin, Edward Knock, Lilith Whittles, John Lees, Raphael Sonabend.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

